# 系统设置

系统设置提供了平台的配置管理、安全审计和个人偏好设置功能。通过系统设置，您可以配置推送服务、监控操作日志、管理个人账号信息。

## ⚙️ 推送配置

推送配置是 DooPush 正常工作的基础，需要为不同平台配置相应的推送服务参数。

### 查看推送配置

在左侧导航点击 **"推送配置"** 进入配置管理页面。

**配置分类**：
- **应用配置** - 应用基本配置信息
- **iOS 配置** - iOS APNs 推送配置
- **Android 配置** - Android 推送配置（SDK 开发中）

### 应用配置

**基本信息**：
- **应用名称** - 应用的显示名称
- **包名** - 应用的唯一标识符
- **支持平台** - iOS、Android 或两者
- **应用状态** - 启用或禁用状态

### iOS 推送配置

iOS 平台使用 Apple Push Notification service (APNs) 进行推送。

#### 创建 iOS 配置

**创建步骤**：
1. 点击 **"添加配置"** 按钮
2. 选择平台为 **"iOS"**
3. 选择通道为 **"APNs"**
4. 填写 APNs 配置信息
5. 点击 **"保存"** 按钮

**配置参数**：

#### 🔑 Key ID
- **作用**：Apple 开发者账号中的推送密钥 ID
- **获取方式**：在 Apple 开发者中心的 "Certificates, Identifiers & Profiles" > "Keys" 中查看
- **格式**：10 位字符串，如 `ABC1234DEF`

#### 👥 Team ID
- **作用**：Apple 开发者团队 ID
- **获取方式**：在 Apple 开发者中心的 "Membership" 页面查看
- **格式**：10 位字符串，如 `DEF5678GHI`

#### 📱 Bundle ID
- **作用**：iOS 应用的 Bundle Identifier
- **要求**：必须与应用的实际 Bundle ID 保持一致
- **格式**：域名反向格式，如 `com.yourcompany.yourapp`

#### 🔐 Private Key
- **作用**：APNs 推送私钥内容
- **格式**：完整的 .p8 私钥文件内容，包含 BEGIN 和 END 标记
- **安全**：私钥信息将加密存储

**私钥格式示例**：
```
-----BEGIN PRIVATE KEY-----
MIGTAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBHkwdwIBAQQg...
-----END PRIVATE KEY-----
```

#### 🌍 推送环境
- **开发环境** - 用于开发和测试阶段
- **生产环境** - 用于正式发布的应用

::: warning ⚠️ 环境选择
确保选择正确的推送环境，否则推送将无法送达。开发版本应用使用开发环境，App Store 版本使用生产环境。
:::

### Android 推送配置

Android 平台支持多个推送通道，包括 FCM 和各厂商通道。

::: info 📱 Android SDK 状态
Android SDK 正在开发中，配置功能将在 SDK 完成后开放。
:::

**规划支持的通道**：
- **FCM** - Firebase Cloud Messaging
- **华为** - HMS Push Kit
- **小米** - 小米推送
- **OPPO** - ColorOS 推送
- **VIVO** - vivo 推送
- **荣耀** - 荣耀推送
- **三星** - Samsung Push

### 配置管理

#### 编辑配置
1. 在配置列表中找到目标配置
2. 点击 **"编辑"** 按钮
3. 修改配置参数
4. 点击 **"保存"** 按钮

#### 测试配置
1. 点击配置的 **"测试"** 按钮
2. 填写测试参数：
   - **设备 Token** - 测试设备的推送 Token
   - **测试标题** - 测试推送的标题
   - **测试内容** - 测试推送的内容
3. 点击 **"发送测试"** 按钮
4. 查看测试结果

#### 删除配置
1. 点击配置的 **"删除"** 按钮
2. 确认删除操作

::: danger 🔒 删除警告
删除推送配置后，相关推送功能将停止工作，请谨慎操作。
:::

### 配置状态

**状态说明**：
- 🟢 **正常** - 配置有效，推送服务正常
- 🔴 **异常** - 配置错误或服务异常
- ⏸️ **禁用** - 配置被手动禁用

**常见问题**：
- **证书过期** - 需要更新 iOS 推送证书
- **密钥错误** - 检查 Key ID、Team ID 是否正确
- **Bundle ID 不匹配** - 确保与应用实际 Bundle ID 一致

## 📋 审计日志

审计日志记录了平台上的所有重要操作，用于安全监控和问题追溯。

### 查看审计日志

在左侧导航点击 **"审计日志"** 进入日志查看页面。

**日志信息**：
- **操作时间** - 操作发生的具体时间
- **操作用户** - 执行操作的用户名
- **操作类型** - 具体的操作行为
- **操作资源** - 被操作的资源类型
- **IP 地址** - 操作来源的 IP 地址
- **操作结果** - 成功或失败状态
- **详细信息** - 操作的具体内容

### 操作类型

**常见操作类型**：
- **创建** (Create) - 创建新的资源
- **更新** (Update) - 修改现有资源
- **删除** (Delete) - 删除资源
- **查看** (Read) - 查看资源信息
- **登录** (Login) - 用户登录系统
- **登出** (Logout) - 用户登出系统

### 资源类型

**记录的资源类型**：
- **应用** (App) - 应用管理操作
- **设备** (Device) - 设备管理操作
- **推送** (Push) - 推送发送操作
- **配置** (Config) - 推送配置操作
- **模板** (Template) - 消息模板操作
- **分组** (Group) - 设备分组操作
- **API密钥** (API Key) - API 密钥管理
- **定时推送** (Scheduled Push) - 定时推送管理

### 筛选和搜索

#### 高级筛选

**操作筛选**：
- 按操作类型筛选（创建、更新、删除等）
- 按资源类型筛选（应用、设备、推送等）

**时间筛选**：
- **开始时间** - 筛选的起始时间
- **结束时间** - 筛选的结束时间
- 支持自定义时间范围

**用户筛选**：
- **用户名** - 按执行操作的用户筛选
- **IP 地址** - 按操作来源 IP 筛选

#### 快速搜索
- 在搜索框中输入关键词
- 支持搜索操作内容和资源信息

### 查看详情

**日志详情信息**：
- **基本信息** - 时间、用户、IP、结果
- **操作内容** - 具体的操作描述
- **资源信息** - 被操作资源的详细信息
- **上下文数据** - 操作时的环境信息

### 导出日志

**导出功能**：
1. 设置筛选条件
2. 点击 **"导出"** 按钮
3. 选择导出格式（Excel、CSV）
4. 下载导出文件

**导出内容**：
- 所有筛选结果的日志记录
- 包含完整的操作信息和详情

### 统计分析

**统计数据**：
- **操作频次** - 各类操作的数量统计
- **用户活跃度** - 用户操作频率分析
- **高峰时段** - 操作集中的时间段
- **异常活动** - 可疑操作的识别

### 权限控制

**查看权限**：
- 只有拥有应用权限的用户才能查看审计日志
- 超级管理员可以查看所有应用的日志
- 普通用户只能查看有权限应用的日志

## 👤 个人设置

个人设置允许您管理账号信息、安全设置和界面偏好。

### 访问个人设置

点击右上角的用户头像，选择 **"个人设置"**，或在左侧导航中点击相关设置项。

### 个人资料

#### 查看和编辑资料

**个人信息**：
- **用户名** - 登录用户名（不可修改）
- **邮箱地址** - 接收通知和密码重置的邮箱
- **显示名称** - 在界面中显示的名称
- **头像** - 个人头像图片

**编辑步骤**：
1. 进入 **"个人资料"** 页面
2. 点击 **"编辑"** 按钮
3. 修改相关信息
4. 点击 **"保存"** 按钮

#### 头像管理

**头像要求**：
- **支持格式**：JPG、PNG、GIF
- **文件大小**：不超过 2MB
- **建议尺寸**：200x200 像素

### 账号安全

#### 修改密码

**密码要求**：
- 长度至少 6 位字符
- 建议包含字母、数字和特殊字符
- 不要使用过于简单的密码

**修改步骤**：
1. 进入 **"修改密码"** 页面
2. 输入当前密码
3. 输入新密码
4. 确认新密码
5. 点击 **"保存"** 按钮

#### 安全日志

**登录记录**：
- 查看最近的登录记录
- 包含登录时间、IP 地址、设备信息
- 发现异常登录及时处理

### 外观设置

#### 主题设置

**主题选项**：
- **浅色主题** - 适合白天使用
- **深色主题** - 适合夜晚使用
- **跟随系统** - 根据系统设置自动切换

#### 语言设置

**支持语言**：
- **简体中文** - 默认语言
- **English** - 英文界面（规划中）

#### 界面偏好

**显示设置**：
- **时间格式** - 12小时制或24小时制
- **日期格式** - 不同的日期显示格式
- **分页大小** - 列表页面每页显示数量

## 🔒 安全建议

### 账号安全

**密码管理**：
- 定期更换密码（建议3-6个月）
- 使用强密码，避免使用生日、姓名等
- 不要在多个平台使用相同密码

**登录安全**：
- 退出时及时登出账号
- 不要在公共设备上保存登录状态
- 发现异常登录立即修改密码

### 推送配置安全

**证书管理**：
- 推送证书和私钥妥善保管
- 不要在代码中硬编码证书信息
- 定期检查证书有效期

**访问控制**：
- 限制推送配置的访问权限
- 定期审查配置人员权限
- 重要操作启用审批流程

### 日志监控

**定期检查**：
- 定期查看审计日志
- 关注异常操作和登录
- 发现问题及时处理

**告警设置**：
- 设置重要操作的通知
- 监控批量操作和删除行为
- 建立安全事件响应流程

## ❓ 常见问题

### Q: iOS 推送配置后测试失败怎么办？
A: 检查 Key ID、Team ID、Bundle ID 是否正确，确认私钥格式完整，验证推送环境选择。

### Q: 审计日志可以保存多长时间？
A: 系统默认保存 90 天的审计日志，超过期限的日志会自动清理。

### Q: 忘记密码怎么办？
A: 在登录页面点击"忘记密码"，通过注册邮箱重置密码。

### Q: 可以同时配置多个 iOS 证书吗？
A: 可以。支持为同一应用配置多个推送配置，用于不同环境或备份。

### Q: 如何确保账号安全？
A: 使用强密码、定期修改密码、及时登出、监控登录记录。

---

*系统设置是平台安全和功能正常运行的保障，请定期检查和维护相关配置。*
